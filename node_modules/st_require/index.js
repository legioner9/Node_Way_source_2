const Path = require('path');
const Fs = require('fs');

const objectExports = {};

const rootDir = __dirname.split(Path.sep);
rootDir.splice(rootDir.length - 2);
const projectDir = rootDir.join(Path.sep);

const _require = () => {
  const pathDot = Path.join(projectDir, '.require');
  if (!Fs.existsSync(pathDot)) throw new Error(`${pathDot} does not exist`);
  const contentArr = Fs.readFileSync(pathDot, 'utf8')
  .split('\n')
  .filter(item => item.length || typeof item !== 'string');

  contentArr.forEach(item => {
  const pathBibset = Path.join(projectDir,item,'bibset.js')
    if (!Fs.existsSync(pathBibset)) throw new Error(`${pathBibset} does not exist`);
    objectExports[item] = require(pathBibset)
  });

  return objectExports;
};

exports._require = _require;
